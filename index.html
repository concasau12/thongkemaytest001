<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω m√°y test</title>
  <link rel="stylesheet" href="style.css">
  <style>
/* ===== MAIN / TABLE ===== */
  main {
    padding: 10px;
    width: 100%;
    overflow-x: auto;
    overflow-y: auto;
    background: #f4f4f4;
    box-sizing: border-box;
    white-space: nowrap;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    min-width: 800px;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 6px;
    text-align: center;
    font-size: 13px;
    word-wrap: break-word;
    white-space: normal;
  }

  th {
    position: relative;
    background-color: #007bff;
    color: white;
    user-select: none;
  }

  th.resizing {
    background-color: #d0ebff;
  }

  th:nth-child(15), td:nth-child(15) { min-width: 200px; max-width: 500px; } 
  th:nth-child(13), td:nth-child(13) { min-width: 90px; max-width: 200px; } 
  th:nth-child(14), td:nth-child(14) { min-width: 50px; max-width: 100px; } 


</style>

</head>

<body>
  <header>
    <h2>üì• Nh·∫≠p D·ªØ Li·ªáu M√°y Test</h2>
    <div class="nav-bar">
        <a href="nhaplieu.html" class="btn-nav" id="btnNhap">Nh·∫≠p li·ªáu</a>
        <div class="search-container">
        <button id="searchBtn" class="btn-nav">üîç</button>
        <input type="text" id="searchInput" placeholder="Nh·∫≠p ng√†y, t√™n m√°y ho·∫∑c ID..." />
        </div>
        <a href="thongke.html" class="btn-nav" id="btnThongke">Th·ªëng k√™</a>
    </div>
  </header>


  <main>
    <table id="dataTable">
      <thead>
        <tr>
          <th>Ng√†y</th>
          <th>T√™n m√°y</th>
          <th>CPU</th>
          <th>RAM</th>
          <th>·ªî c·ª©ng</th>
          <th>M√†n h√¨nh</th>
          <th>GPU</th>
          <th>Cam</th>
          <th>Led</th>
          <th>V√¢n</th>
          <th>Pin</th>
          <th>ID</th>
          <th>T√¨nh tr·∫°ng v·ªè</th>
          <th>Ghi ch√∫</th>
          <th>T·ªïng</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- D·ªØ li·ªáu s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y -->
      </tbody>
    </table>
  </main>

  <script>
    const API_URL = "https://thongkemaytest001.onrender.c";
    const btnSearch = document.getElementById("searchBtn");
    const searchInput = document.getElementById("searchInput");
    const navBar = document.querySelector(".nav-bar");
    let isSearchVisible = false;
    let allData = [];

    // üéØ Hi·ªÉn th·ªã/·∫©n √¥ t√¨m ki·∫øm + hi·ªáu ·ª©ng ƒë·∫©y n√∫t ra hai b√™n
    btnSearch.addEventListener("click", () => {
        isSearchVisible = !isSearchVisible;

        navBar.classList.toggle("nav-expanded", isSearchVisible);
        btnSearch.parentElement.classList.toggle("search-active", isSearchVisible);

        if (isSearchVisible) {
        searchInput.focus();
        } else {
        searchInput.value = "";
        renderTable(allData);
        }
    });

    // üìÑ L·∫•y d·ªØ li·ªáu t·ª´ server
    async function loadData() {
        try {
        const res = await fetch(`${API_URL}/data`);
        const rows = await res.json();

        allData = rows.slice(2).map(r => ({
            Ngay: r[0] || "",
            Tenmay: r[1] || "",
            CPU: r[2] || "",
            RAM: r[3] || "",
            OCung: r[4] || "",
            Manhinh: r[5] || "",
            GPU: r[6] || "",
            Cam: r[7] || "",
            Led: r[8] || "",
            Van: r[9] || "",
            Pin: r[10] || "",
            ID: r[11] || "",
            Vo: r[12] || "",
            Ghichu: r[13] || "",
            Tong: r[14] || ""
        }));

        renderTable(allData);
        } catch (err) {
        console.error("‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu:", err);
        }
    }

    // üßæ Hi·ªÉn th·ªã d·ªØ li·ªáu ra b·∫£ng
    function renderTable(data) {
        const body = document.getElementById("tableBody");
        if (!body) return;
        body.innerHTML = data.map(r => `
        <tr>
            <td>${r.Ngay}</td>
            <td>${r.Tenmay}</td>
            <td>${r.CPU}</td>
            <td>${r.RAM}</td>
            <td>${r.OCung}</td>
            <td>${r.Manhinh}</td>
            <td>${r.GPU}</td>
            <td>${r.Cam}</td>
            <td>${r.Led}</td>
            <td>${r.Van}</td>
            <td>${r.Pin}</td>
            <td>${r.ID}</td>
            <td>${r.Vo}</td>
            <td>${r.Ghichu}</td>
            <td>${r.Tong}</td>
        </tr>
        `).join("");
    }

    // üîç L·ªçc d·ªØ li·ªáu theo t·ª´ kh√≥a (ng√†y, t√™n m√°y, ID)
    searchInput.addEventListener("input", () => {
        const keyword = searchInput.value.toLowerCase();
        const filtered = allData.filter(r =>
        r.Ngay.toLowerCase().includes(keyword) ||
        r.Tenmay.toLowerCase().includes(keyword) ||
        r.ID.toLowerCase().includes(keyword)
        );
        renderTable(filtered);
    });

    // üöÄ G·ªçi h√†m load d·ªØ li·ªáu khi trang load xong
    document.addEventListener("DOMContentLoaded", loadData);
    // ‚úã Cho ph√©p k√©o thay ƒë·ªïi ƒë·ªô r·ªông c·ªôt
    document.querySelectorAll("th").forEach(th => {
        const grip = document.createElement("div");
        grip.style.position = "absolute";
        grip.style.right = "0";
        grip.style.top = "0";
        grip.style.width = "5px";
        grip.style.cursor = "col-resize";
        grip.style.userSelect = "none";
        grip.style.height = "100%";
        th.appendChild(grip);

        let startX, startWidth;

        grip.addEventListener("mousedown", e => {
            startX = e.pageX;
            startWidth = th.offsetWidth;
            th.classList.add("resizing");
            document.addEventListener("mousemove", resize);
            document.addEventListener("mouseup", stopResize);
        });

        function resize(e) {
            const diff = e.pageX - startX;
            th.style.width = `${startWidth + diff}px`;
        }

        function stopResize() {
            th.classList.remove("resizing");
            document.removeEventListener("mousemove", resize);
            document.removeEventListener("mouseup", stopResize);
        }
        });
        th.style.minWidth = `${startWidth + diff}px`;
        th.style.maxWidth = `${startWidth + diff}px`;


    </script>

</body>
</html>
